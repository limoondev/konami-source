// ============================================================================
// Konami Client - Toggle/Switch Component
// Smooth animated toggle switches
// ============================================================================

import { Theme } from "../theme/theme.slint";

export component KonamiToggle inherits Rectangle {
    in-out property <bool> checked: false;
    in property <bool> disabled: false;
    in property <string> label: "";
    
    callback toggled(bool);
    
    property <duration> anim-duration: 250ms;
    property <bool> is-hovered: false;
    
    width: label != "" ? 100% : 52px;
    height: 32px;
    
    HorizontalLayout {
        spacing: 12px;
        
        // Toggle track
        Rectangle {
            width: 52px;
            height: 28px;
            border-radius: 14px;
            background: checked ? Theme.primary : Theme.surface-hover;
            border-width: checked ? 0px : 1px;
            border-color: Theme.border;
            
            animate background { duration: anim-duration; easing: ease-out; }
            
            // Glow effect when checked
            Rectangle {
                width: 100%;
                height: 100%;
                border-radius: 14px;
                background: checked ? Theme.primary.with-alpha(0.3) : transparent;
                
                animate background { duration: anim-duration; }
            }
            
            // Toggle knob
            Rectangle {
                x: checked ? 26px : 4px;
                y: 4px;
                width: 20px;
                height: 20px;
                border-radius: 10px;
                background: white;
                drop-shadow-blur: checked ? 8px : 4px;
                drop-shadow-color: checked ? Theme.primary.with-alpha(0.4) : #00000020;
                
                animate x, drop-shadow-blur, drop-shadow-color { 
                    duration: anim-duration; 
                    easing: ease-out; 
                }
                
                // Inner highlight
                Rectangle {
                    x: 4px;
                    y: 4px;
                    width: 8px;
                    height: 8px;
                    border-radius: 4px;
                    background: checked ? Theme.primary.with-alpha(0.3) : #00000010;
                    
                    animate background { duration: anim-duration; }
                }
            }
            
            TouchArea {
                enabled: !disabled;
                mouse-cursor: disabled ? not-allowed : pointer;
                
                clicked => {
                    checked = !checked;
                    toggled(checked);
                }
            }
        }
        
        // Label
        if label != "": Text {
            vertical-alignment: center;
            text: label;
            color: disabled ? Theme.text-muted : Theme.text-primary;
            font-size: 14px;
        }
    }
}

// Checkbox style toggle
export component KonamiCheckbox inherits Rectangle {
    in-out property <bool> checked: false;
    in property <bool> disabled: false;
    in property <string> label: "";
    
    callback toggled(bool);
    
    property <duration> anim-duration: 200ms;
    
    width: 100%;
    height: 24px;
    
    HorizontalLayout {
        spacing: 12px;
        
        Rectangle {
            width: 22px;
            height: 22px;
            border-radius: 6px;
            background: checked ? Theme.primary : transparent;
            border-width: checked ? 0px : 2px;
            border-color: checked ? Theme.primary : Theme.border;
            
            animate background, border-color, border-width { 
                duration: anim-duration; 
                easing: ease-out; 
            }
            
            // Checkmark
            Text {
                text: "âœ“";
                color: white;
                font-size: 14px;
                font-weight: 700;
                opacity: checked ? 1 : 0;
                
                animate opacity { duration: anim-duration; }
            }
            
            TouchArea {
                enabled: !disabled;
                mouse-cursor: disabled ? not-allowed : pointer;
                
                clicked => {
                    checked = !checked;
                    toggled(checked);
                }
            }
        }
        
        if label != "": Text {
            vertical-alignment: center;
            text: label;
            color: disabled ? Theme.text-muted : Theme.text-primary;
            font-size: 14px;
            
            TouchArea {
                enabled: !disabled;
                mouse-cursor: pointer;
                
                clicked => {
                    checked = !checked;
                    toggled(checked);
                }
            }
        }
    }
}

// Radio button
export component KonamiRadio inherits Rectangle {
    in-out property <bool> selected: false;
    in property <bool> disabled: false;
    in property <string> label: "";
    
    callback clicked();
    
    property <duration> anim-duration: 200ms;
    
    width: 100%;
    height: 24px;
    
    HorizontalLayout {
        spacing: 12px;
        
        Rectangle {
            width: 22px;
            height: 22px;
            border-radius: 11px;
            background: transparent;
            border-width: 2px;
            border-color: selected ? Theme.primary : Theme.border;
            
            animate border-color { duration: anim-duration; }
            
            // Inner dot
            Rectangle {
                width: selected ? 12px : 0px;
                height: selected ? 12px : 0px;
                border-radius: 6px;
                background: Theme.primary;
                
                animate width, height { duration: anim-duration; easing: ease-out; }
            }
            
            TouchArea {
                enabled: !disabled;
                mouse-cursor: disabled ? not-allowed : pointer;
                
                clicked => {
                    root.clicked();
                }
            }
        }
        
        if label != "": Text {
            vertical-alignment: center;
            text: label;
            color: disabled ? Theme.text-muted : Theme.text-primary;
            font-size: 14px;
            
            TouchArea {
                enabled: !disabled;
                mouse-cursor: pointer;
                
                clicked => {
                    root.clicked();
                }
            }
        }
    }
}
